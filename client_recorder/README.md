# VAD语音检测客户端

这是一个基于Silero VAD (Voice Activity Detection) 的客户端程序，用于实时检测语音活动，录制音频，并发送到服务器进行处理。

## 功能特点

- **实时语音检测**：使用Silero VAD模型检测用户说话活动
- **自动录音**：检测到语音开始时自动开始录音，静音结束后自动停止
- **智能分段**：根据语音活动自动分段，避免长时间静音
- **服务器集成**：将录制的语音片段发送到服务器进行识别
- **历史记录**：保存识别结果和音频文件，支持回溯查询
- **环境变量支持**：通过.env文件或命令行参数自定义配置

## 目录结构

```
client/
├── vad_client.py           # 主客户端程序
├── .env                    # 环境变量配置文件
├── file_record.json        # 录音历史记录
├── recordings/             # 录音文件存储目录
│   └── 20250411090827_2025041109082859.wav  # 按时间戳命名的录音文件
└── models/                 # VAD模型目录
    └── silero_vad.jit      # 预训练的VAD模型
```

## 系统要求

- Python 3.8+
- 麦克风设备
- 网络连接（连接到语音识别服务器）


## 实现细节

### VAD模型

客户端使用Silero VAD模型进行语音活动检测。首次运行时，如果`models`目录下不存在模型文件，将自动从Torch Hub下载并保存。

### 录音逻辑

1. 客户端启动时建立与服务器的连接
2. 不断采集麦克风音频数据
3. 将音频数据送入VAD模型进行检测
4. 检测到语音时开始录制，并保持录制直到检测到足够长的静音
5. 录音结束后将WAV文件保存到本地并发送到服务器

### 文件命名

录音文件采用双时间戳命名格式：`YYYYMMDDHHMMSS_YYYYMMDDHHMMSSXX.wav`，确保唯一性和时间顺序。

### 服务器通信

客户端使用HTTP协议与服务器通信，具体为：
- 使用multipart/form-data格式发送音频文件
- 音频文件字段名为'file'
- 同时发送'domain'等参数
- 接收并解析服务器返回的JSON响应
